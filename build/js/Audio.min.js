/*!
 * Audio: Audio driver and sound output.
 * Copyright (c) 2015 Martin Borik <mborik@users.sourceforge.net>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom
 * the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF
 * OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
var AudioDriver=function(){function a(a,b,c){var d=1e3/c,e=d*b,f=e/1e3*a,g=Math.ceil(Math.log(f)*Math.LOG2E);return 1<<Math.min(Math.max(g,8),14)}function b(){var b=this,c=null,d=null,e=getCompatible(window,"AudioContext",!0),f=function(a){var b=a.outputBuffer;c.getAudio(b.getChannelData(0),b.getChannelData(1),b.length)};return this.interruptFrequency=50,this.bufferCount=4,this.bufferSize=4096,this.sampleRate=e.sampleRate,this.setAudioSource=function(a){c=a},this.play=function(){c&&c.getAudio&&!d.onaudioprocess&&(d.onaudioprocess=f,d.connect(e.destination),e.resume())},this.stop=function(){e.suspend(),d.onaudioprocess&&d.disconnect(e.destination),d.onaudioprocess=null},this.init=function(c,f,g){d&&(b.stop(),d=null),c&&b.setAudioSource(c),f&&(b.bufferCount=f),g&&(b.interruptFrequency=g),b.bufferSize=a(b.sampleRate,b.bufferCount,b.interruptFrequency),null!==e.createScriptProcessor?d=e.createScriptProcessor(b.bufferSize,0,2):null!==e.createJavaScriptNode&&(d=e.createJavaScriptNode(b.bufferSize,0,2)),d.onaudioprocess=null,b.bufferSize=d.bufferSize},this}try{return new b}catch(a){throw"Error: WebAudioAPI not found (incompatible or obsolete browser)"}}();