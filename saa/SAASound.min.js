/*
 * SAA1099Tracker v1.0.0
 * Copyright (c) 2011-2015 Martin BÃ³rik <mborik@users.sourceforge.net>
 */
var SAASound;!function(a){function b(){}a.nSampleRate,a.nBufferSize;var c=[new a.SAAEnv,new a.SAAEnv],d=[new a.SAANoise(347034121),new a.SAANoise(1990832414)],e=[new a.SAAFreq(d[0],void 0),new a.SAAFreq(void 0,c[0]),new a.SAAFreq(void 0,void 0),new a.SAAFreq(d[1],void 0),new a.SAAFreq(void 0,c[0]),new a.SAAFreq(void 0,void 0)];[new a.SAAAmp(e[0],d[0],void 0),new a.SAAAmp(e[1],d[0],void 0),new a.SAAAmp(e[2],d[0],c[0]),new a.SAAAmp(e[3],d[1],void 0),new a.SAAAmp(e[4],d[1],void 0),new a.SAAAmp(e[5],d[1],c[1])];a.Clear=b}(SAASound||(SAASound={}));var SAASound;!function(a){var b=function(){function a(a,b,c){this.pcConnectedToneGenerator=a,this.pcConnectedNoiseGenerator=b,this.pcConnectedEnvGenerator=c,this.bUseEnvelope=!!c,this.leftleveltimes32=this.leftleveltimes16=this.leftlevela0x0e=this.leftlevela0x0etimes2=0,this.rightleveltimes32=this.rightleveltimes16=this.rightlevela0x0e=this.rightlevela0x0etimes2=0,this.monoleveltimes32=this.monoleveltimes16=0,this.bMute=!0,this.nMixMode=0,this.nOutputIntermediate=0,this.last_level_byte=0,this.level_unchanged=!1,this.last_leftlevel=this.last_rightlevel=0,this.leftlevel_unchanged=this.rightlevel_unchanged=!1,this.cached_last_leftoutput=this.cached_last_rightoutput=0}return a.prototype.SetAmpLevel=function(a){(a&=255)!=this.last_level_byte&&(this.last_level_byte=a,this.leftlevela0x0e=14&a,this.leftlevela0x0etimes2=this.leftlevela0x0e<<1,this.leftleveltimes16=(15&a)<<4,this.leftleveltimes32=this.leftleveltimes16<<1,this.rightlevela0x0e=a>>4&14,this.rightlevela0x0etimes2=this.rightlevela0x0e<<1,this.rightleveltimes16=240&a,this.rightleveltimes32=this.rightleveltimes16<<1,this.monoleveltimes16=this.leftleveltimes16+this.rightleveltimes16,this.monoleveltimes32=this.leftleveltimes32+this.rightleveltimes32)},a.prototype.SetToneMixer=function(a){a?this.nMixMode|=1:this.nMixMode&=-2},a.prototype.SetNoiseMixer=function(a){a?this.nMixMode|=2:this.nMixMode&=-3},a.prototype.Tick=function(){switch(this.nMixMode){case 0:this.pcConnectedToneGenerator.Tick(),this.nOutputIntermediate=0;break;case 1:this.nOutputIntermediate=this.pcConnectedToneGenerator.Tick();break;case 2:this.pcConnectedToneGenerator.Tick(),this.nOutputIntermediate=this.pcConnectedNoiseGenerator.Level();break;case 3:this.nOutputIntermediate=this.pcConnectedToneGenerator.Tick(),2===this.nOutputIntermediate&&this.pcConnectedNoiseGenerator.Level()&&(this.nOutputIntermediate=1)}},a.prototype.TickAndOutputStereo=function(){this.Tick();var a={Left:0,Right:0,DWORD:0},b=this.nOutputIntermediate;return this.bMute?a:(this.bUseEnvelope&&this.pcConnectedEnvGenerator.IsActive()?0===b?(a.Left=this.pcConnectedEnvGenerator.LeftLevel()*this.leftlevela0x0etimes2,a.Right=this.pcConnectedEnvGenerator.RightLevel()*this.rightlevela0x0etimes2):1===b&&(a.Left=this.pcConnectedEnvGenerator.LeftLevel()*this.leftlevela0x0e,a.Right=this.pcConnectedEnvGenerator.RightLevel()*this.rightlevela0x0e):1===b?(a.Left=this.leftleveltimes16,a.Right=this.rightleveltimes16):2===b&&(a.Left=this.leftleveltimes32,a.Right=this.rightleveltimes32),a.DWORD=a.Right<<16|a.Left,a)},a}();a.SAAAmp=b}(SAASound||(SAASound={}));var SAASound;!function(a){var b=function(){function a(){this.cs_EnvData=[{nPhases:1,bLooping:!1,aLevels:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]},{nPhases:1,bLooping:!0,aLevels:[[[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]],[[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14]]]},{nPhases:1,bLooping:!1,aLevels:[[[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[14,14,12,12,10,10,8,8,6,6,4,4,2,2,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]},{nPhases:1,bLooping:!0,aLevels:[[[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[14,14,12,12,10,10,8,8,6,6,4,4,2,2,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]},{nPhases:2,bLooping:!1,aLevels:[[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0]],[[0,0,2,2,4,4,6,6,8,8,10,10,12,12,14,14],[14,14,12,12,10,10,8,8,6,6,4,4,2,2,0,0]]]},{nPhases:2,bLooping:!0,aLevels:[[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0]],[[0,0,2,2,4,4,6,6,8,8,10,10,12,12,14,14],[14,14,12,12,10,10,8,8,6,6,4,4,2,2,0,0]]]},{nPhases:1,bLooping:!1,aLevels:[[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,2,2,4,4,6,6,8,8,10,10,12,12,14,14],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]},{nPhases:1,bLooping:!0,aLevels:[[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,2,2,4,4,6,6,8,8,10,10,12,12,14,14],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]}],this.bEnabled=!1,this.bNewData=!1,this.nNextData=0,this.bOkForNewData=!1,this.SetNewEnvData()}return a.prototype.InternalClock=function(){this.bEnabled&&!this.bClockExternally&&this.Tick()},a.prototype.ExternalClock=function(){this.bEnabled&&this.bClockExternally&&this.Tick()},a.prototype.SetEnvControl=function(a){return this.nResolution=!!(16&a),this.bEnabled=!!(128&a),this.bEnabled?void(this.bOkForNewData?(this.SetNewEnvData(a),this.bNewData=!1,this.bOkForNewData=!1):(this.SetLevels(),this.bNewData=!0,this.nNextData=a)):(this.nPhase=0,this.nPhasePosition=0,this.bEnded=!0,this.bOkForNewData=!0,this.bNewData=!0,this.nNextData=a,this.SetLevels())},a.prototype.Tick=function(){return this.bEnabled?void(this.bEnded||(this.nPhasePosition+=this.nResolution?2:1,this.nPhasePosition>=16?(this.nPhase++,this.nPhasePosition-=16,this.nPhase===this.nPhases?(this.bOkForNewData=!0,this.bLooping?(this.bEnded=!1,this.nPhase=0):(this.bEnded=!0,this.nPhase=this.nPhases-1,this.nPhasePosition=15,this.bOkForNewData=!0)):this.bOkForNewData=!1):this.bOkForNewData=!1,this.bNewData&&this.bOkForNewData?(this.bNewData=!1,this.bOkForNewData=!1,this.SetNewEnvData(this.nNextData)):this.SetLevels())):(this.bEnded=!0,this.nPhase=0,this.nPhasePosition=0,void(this.bOkForNewData=!0))},a.prototype.SetLevels=function(){var a=0+this.nResolution;this.nLeftLevel=this.pEnvData.aLevels[a][this.nPhase][this.nPhasePosition],this.bStereo?this.nRightLevel=15-a-this.nLeftLevel:this.nRightLevel=this.nLeftLevel},a.prototype.SetNewEnvData=function(a){void 0===a&&(a=0),this.nPhase=0,this.nPhasePosition=0,this.pEnvData=this.cs_EnvData[a>>1&7],this.bStereo=!!(1&a),this.bClockExternally=!!(32&a),this.nPhases=this.pEnvData.nPhases,this.bLooping=this.pEnvData.bLooping,this.nResolution=!!(16&a),this.bEnabled=!!(128&a),this.bEnabled?this.bEnded=!1:(this.bEnded=!0,this.nPhase=0,this.nPhasePosition=0,this.bOkForNewData=!0),this.SetLevels()},a.prototype.LeftLevel=function(){return this.nLeftLevel},a.prototype.RightLevel=function(){return this.nRightLevel},a.prototype.IsActive=function(){return this.bEnabled},a}();a.SAAEnv=b}(SAASound||(SAASound={}));var SAASound;!function(a){var b=function(){function b(b,c){this.nLevel=2,this.nCounter=this.nAdd=0,this.nCurrentOffset=this.nCurrentOctave=0,this.nNextOffset=this.nNextOctave=0,this.bIgnoreOffsetData=this.bNewData=this.bSync=!1,this.nSmpRate=a.nSampleRate*a.nBufferSize,this.pcConnectedNoiseGenerator=b,this.pcConnectedEnvGenerator=c,this.nConnectedMode=b?c?0:1:2,this.SetAdd()}return b.prototype.Level=function(){return this.nLevel},b.prototype.SetFreqOffset=function(a){this.bSync?(this.bNewData=!1,this.nCurrentOffset=a,this.nCurrentOctave=this.nNextOctave,this.SetAdd()):(this.nNextOffset=a,this.bNewData=!0,this.nNextOctave==this.nCurrentOctave&&(this.bIgnoreOffsetData=!0))},b.prototype.SetFreqOctave=function(a){this.bSync?(this.bNewData=!1,this.nCurrentOctave=a,this.nCurrentOffset=this.nNextOffset,this.SetAdd()):(this.nNextOctave=a,this.bNewData=!0,this.bIgnoreOffsetData=!1)},b.prototype.UpdateOctaveOffsetData=function(){this.bNewData&&(this.nCurrentOctave=this.nNextOctave,this.bIgnoreOffsetData||(this.nCurrentOffset=this.nNextOffset,this.bNewData=!1),this.bIgnoreOffsetData=!1,this.SetAdd())},b.prototype.Tick=function(){if(!this.bSync&&(this.nCounter+=this.nAdd,this.nCounter>=this.nSmpRate)){for(;this.nCounter>=this.nSmpRate;)this.nCounter-=this.nSmpRate,this.nLevel=2-this.nLevel,1===this.nConnectedMode?this.pcConnectedEnvGenerator.InternalClock():2===this.nConnectedMode&&this.pcConnectedNoiseGenerator.Trigger();this.UpdateOctaveOffsetData()}return this.nLevel},b.prototype.Sync=function(a){this.bSync=a,a&&(this.nCounter=0,this.nLevel=2,this.nCurrentOctave=this.nNextOctave,this.nCurrentOffset=this.nNextOffset,this.SetAdd())},b.prototype.SetAdd=function(){this.nAdd=(15625<<this.nCurrentOctave)/(511-this.nCurrentOffset)>>0},b}();a.SAAFreq=b}(SAASound||(SAASound={}));var SAASound;!function(a){var b=function(){function b(b){void 0===b&&(b=286331153),this.nCounter=0,this.nAdd=31250*a.nBufferSize,this.bSync=!1,this.nSmpRate=a.nSampleRate*a.nBufferSize,this.nSource=0,this.nRand=b}return b.prototype.Level=function(){return(1&this.nRand)<<1},b.prototype.SetSource=function(b){this.nSource=b&=3,this.nAdd=(31250>>b)*a.nBufferSize},b.prototype.Trigger=function(){3===this.nSource&&this.ChangeLevel()},b.prototype.Tick=function(){if(!this.bSync&&3!=this.nSource&&(this.nCounter+=this.nAdd,this.nCounter>=this.nSmpRate))for(;this.nCounter>=this.nSmpRate;)this.nCounter-=this.nSmpRate,this.ChangeLevel();return 1&this.nRand},b.prototype.Sync=function(a){a&&(this.nCounter=0),this.bSync=a},b.prototype.ChangeLevel=function(){1073741828&this.nRand&&1073741828!=(1073741828&this.nRand)?this.nRand=this.nRand<<1|1:this.nRand<<=1},b}();a.SAANoise=b}(SAASound||(SAASound={}));